<!DOCTYPE html>
<html>
	<head>
		<title>Ping Pong Game</title>
		<style>
			* {
				margin: 0;
				overflow: hidden;
			}
			canvas {
				box-shadow: black 5px 10px 50px;
				margin-top: 50vh;
				margin-left: 30px;
				transform: translateY(-50%);
			}
		</style>
	</head>
	<body>
		<canvas id="canvas"></canvas>
		<script type="text/javascript" src="js/app.js"></script>
		<script type="text/javascript" src="js/nodes.js"></script>
		<script type="text/javascript" src="js/getterValues.js"></script>
		<script type="text/javascript" src="js/drawText.js"></script>
		<script type="text/javascript" src="js/initGameStates.js"></script>
		<script type="text/javascript" src="js/movementAndCollision.js"></script>
		<script type="text/javascript" src="js/utils.js"></script>
		<script type="text/javascript" src="js/constants.js"></script>
		<script type="text/javascript">
			app.onInit = function () {
				initGameStates.removeOldEventListeners();

				addBall();
				addPlayer(PLAYER_ONE, PLAYER_X_POS());
				addPlayer(PLAYER_TWO, app.width - PLAYER_X_POS() * 2);
				addPauseScreenOverlay();

				initGameStates.addNewEventListeners();
			};

			app.onUpdate = function (time) {
				const ball = this.getNode(BALL);
				const player1 = this.getNode(PLAYER_ONE);
				const player2 = this.getNode(PLAYER_TWO);

				if (ball.speed < MIN_BALL_SPEED) ball.speed = MIN_BALL_SPEED; // minimum ball speed

				drawPlayerScore(player1.score, PLAYER_ONE_SCORE_POS);
				drawPlayerScore(player2.score, PLAYER_TWO_SCORE_POS);

				if (this.paused) {
					drawPausedTitle();
					drawPausedSubtitle();
					drawRestartCommandOptions();
					return;
				}

				if (!this.freezeGame) {
					movePlayer(player1, time);
					movePlayer(player2, time);
					moveBall(ball);
					checkHasBallHitBoundary(ball);
					checkHasPlayerScored(ball);
					checkBallPlayerCollision(ball);
				}
			};
		</script>
	</body>
</html>
